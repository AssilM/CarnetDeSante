---
description: 
globs: 
alwaysApply: true
---
# Principes de Sécurité Incontournables

## 1. Mots de passe
- **NE JAMAIS** stocker ou logger les mots de passe en clair.
- Toujours utiliser `bcrypt` pour hacher les mots de passe à l'inscription et les comparer à la connexion.

## 2. Autorisations
- La validation du rôle ne suffit pas.
- Pour chaque accès à une ressource (ex: `GET /document/123`), vérifier que l'ID de l'utilisateur du token correspond bien au propriétaire de la ressource.

## 3. Exposition de Données
- Ne jamais renvoyer le mot de passe haché ou d'autres informations sensibles dans les réponses API.
- Sélectionner manuellement les champs à retourner au client.

