---
description: 
globs: 
alwaysApply: true
---
# Règles pour le Backend (Node.js & Express)

## 1. Structure des Contrôleurs
- Toujours utiliser `async/await` pour gérer les opérations asynchrones.
- Enrober la logique dans un bloc `try...catch`.
- Centraliser la gestion des erreurs en appelant `next(error)` dans le bloc `catch`.

<example>
✅ **Bon :**
```javascript
export const getPatientData = async (req, res, next) => {
  try {
    const data = await patientService.find(req.params.id);
    res.status(200).json(data);
  } catch (error) {
    next(error);
  }
};
```
</example>

## 2. Réponses API
- Les réponses de succès doivent être envoyées avec `res.status(CODE).json(DATA)`.
- Les erreurs gérées par le middleware d'erreur centralisé.
- Utiliser les codes HTTP standards (200, 201, 400, 401, 403, 404, 500).

## 3. Sécurité des Routes
- Toute route nécessitant une authentification doit utiliser le `authMiddleware`.
- Toute route accédant à une ressource spécifique doit vérifier que l'utilisateur authentifié a les droits nécessaires (ex: le patient ne peut voir que ses propres RDV).

